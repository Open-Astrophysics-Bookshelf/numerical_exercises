
\section{WENO methods for the Euler equations}
\label{sec:weno-euler}

When dealing with nonlinear systems the flux split method introduced in
section~\ref{sec:weno-burgers-fvs} generalizes directly. The simplest, and most
diffusive flux splitting uses the maximum characteristic speed $\alpha$. For a
system, such as the Euler equations, the simplest method is to compute $\alpha$
by maximizing over all characteristics. The directional fluxes $\Fb^{(\pm)}(u)$
can then be reconstructed using a high order WENO scheme component by component.

However, this approach can lead to significant oscillations, even in moderate
tests. Rather than doing the reconstruction of the components of the directional
fluxes, a safer approach is to work with characteristic variables. The
discussion in chapter~\ref{ch:compressible-theory} suggests that, by computing
the left and right eigenvectors of the appropriate Jacobian matrix
$\Ab = \partial \Fb/\partial \Uc$, we can project the directional fluxes into
the directional \emph{characteristic} fluxes (using the left eigenvectors),
reconstruct these characteristic fluxes using a high order method, and then
compute the reconstructed directional fluxes required (using the right
eigenvectors). As the characteristic fluxes should contain information about
only a single wave at a time, this \emph{should} give similar results to the
scalar case and reduce problems from close waves from different families.

The Jacobian matrix needs to be computed separately for each point at which the
flux needs computing. The best choice of state from which the Jacobian is
computed is not clear: often the arithmetic average of neighbouring states is
used, but more complex choices can give better results.

A direct comparison of component-wise and characteristic-wise flux-vector split
WENO methods, applied to the Sod test, is given in
figure~\ref{fig:weno-euler-r3} for $r=3$ and in figure~\ref{fig:weno-euler-r5}
for $r=5$. The comparison to the PPM method in figure~\ref{fig:Euler:sod:ppm} is
particularly instructive. The PPM method is specifically designed for
hydrodynamic problems, and is much better at cleanly capturing the
discontinuities, especially the contact. The WENO approach will have a higher
order of accuracy, which will be clearest on tests with more smooth variation.
The oscillations introduced by the WENO methods are more pronounced as the
order is increased, but are reduced by the use of characteristic-wise
reconstruction. This is most clearly seen in the results for the internal energy
in the $r=5$ case shown in figure~\ref{fig:weno-euler-r5}.

\begin{figure}[t]
\centering
% figure generated by hydro_examples/compressible/weno-euler.py
\includegraphics[width=0.8\linewidth]{weno-euler-r3}
\caption[WENO $r=3$ for the Sod test]
{\label{fig:weno-euler-r3} The Sod test solved with WENO methods, $r=3$, using characteristic-wise and component-wise reconstruction, using 64 zones and a cfl of $0.5$. To compare with Godunov's method see figure~\ref{fig:Euler:sod:god} and with PPM see figure~\ref{fig:Euler:sod:ppm}. The WENO method does not capture discontinuities, especially the contact, as well as the PPM method which is specifically designed for the Euler equations. The small oscillations visible in the component-wise reconstruction are damped by using the more complex and expensive characteristic-wise approach. \\
\hydroexdoit{\href{https://github.com/python-hydro/hydro_examples/blob/master/compressible/weno_euler.py}{weno\_euler.py}}}
\end{figure}
%

\begin{figure}[t]
\centering
% figure generated by hydro_examples/compressible/weno-euler.py
\includegraphics[width=0.8\linewidth]{weno-euler-r5}
\caption[WENO $r=5$ for the Sod test]
{\label{fig:weno-euler-r5} The Sod test solved with WENO methods, $r=5$, using characteristic-wise and component-wise reconstruction, using 64 zones and a cfl of $0.5$. Compare with figure~\ref{fig:weno-euler-r3} to see the effect of the higher order of WENO scheme. The oscillations in the component-wise approach are much more pronounced as the order of the reconstruction is increased, and the characteristic-wise approach continues to help with this. \\
\hydroexdoit{\href{https://github.com/python-hydro/hydro_examples/blob/master/compressible/weno_euler.py}{weno\_euler.py}}}
\end{figure}
%

Another illustration of the advantages of a numerical method, such as PPM, that
is specifically designed for the Euler equations, is shown in the double
rarefaction test in figure~\ref{fig:weno-euler-rarefaction-r3}. The
advantages of the higher order methods are shown by how well the WENO schemes
capture the edges of the rarefaction waves, even with so few points and the
diffusive Lax-Friedrichs flux splitting. However, the artificial heating effect
seen at the trivial contact at the center of the domain is about as bad as that
from piecewise constant reconstruction, and nowhere near as good as PPM. Whilst
increasing the reconstruction order has a small impact, a less diffusive flux
splitting would be needed to approach PPM's performance.

\begin{figure}[t]
\centering
% figure generated by hydro_examples/compressible/weno-euler.py
\includegraphics[width=0.8\linewidth]{weno-euler-rarefaction-r3}
\caption[WENO $r=3$ for the double rarefaction test]
{\label{fig:weno-euler-rarefaction-r3} The double rarefaction test solved with WENO methods, $r=3$, using characteristic-wise and component-wise reconstruction, using 64 zones and a cfl of $0.5$. To compare with Godunov's method see figure~\ref{fig:Euler:doublerare:god} and with PPM see figure~\ref{fig:Euler:doublerare:ppm}. The WENO method captures the edges of the rarefactions almost as well as the PPM method, but is as almost as poor as Godunov's method at the trivial contact at the center. A less diffusive flux-splitting may help here. Increasing the reconstruction order has little effect.\\
\hydroexdoit{\href{https://github.com/python-hydro/hydro_examples/blob/master/compressible/weno_euler.py}{weno\_euler.py}}}
\end{figure}
%

\subsection{Extensions}

The main advantage of the WENO method is that it retains its high order when
extending to multiple dimensions using dimensional splitting. From the
finite-difference form there are no transverse Riemann problems to solve. From
using the Method of Lines there is no issue about ordering the dimensional
sweeps: the updates in each direction are computed separately but applied
together in the time integrator. This formally retains the high-order accuracy
but can lose significant absolute accuracy -- compare the advection of a
top-hat function with lower order methods using transverse Riemann problem
solutions.

The global Lax-Friedrichs flux splitting above can be excessively diffusive. A
local Lax-Friedrichs flux splitting, where $\alpha$ is computed at each point
by maximising over the characteristic speed within the stencil at that point, is
less diffusive but slightly more expensive. Roe-style flux splittings are
possible but not always stable.
